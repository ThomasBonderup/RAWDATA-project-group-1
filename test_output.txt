-- GROUP: RAW1, MEMBERS: <Alex Tao Korsgaard Wogelius>, <Emilie Beske Unna-Lindhard>, <Nils Müllenborn>, <Thomas Winther Bonderup>
-- test script for testing function and procedures
SET search_path TO movie_data_model;
SET
-- D.1.
-- D.2 Simple Search
-- Test case: find all movies with simple search with 1 parameter on title name or plot
--   	      select on search_history before an after to check if search string is stored  
SELECT * FROM search_history;
   uconst   |           tstamp           |    search     
------------+----------------------------+---------------
 ui000001   | 2020-10-08 14:23:51.904682 | harry potter
 ui000001   | 2020-09-09 16:29:11.904682 | Dicaprio
 ui000002   | 2020-02-11 19:41:31.904682 | apples
 ui000002   | 2020-01-02 15:19:41.904682 | 2008
 ui000002   | 2020-07-06 16:42:41.904682 | rupert gint
 ui000003   | 2020-10-23 12:29:21.904682 | good place
 ui000003   | 2020-09-09 16:29:11.904682 | teeth
 ui000003   | 2020-02-11 19:41:31.904682 | limitless
 ui000003   | 2020-01-02 15:19:41.904682 | 2008
 ui000004   | 2020-07-06 16:42:41.904682 | skjdsdf
 ui000004   | 2020-10-23 12:29:21.904682 | agent 47
 ui000004   | 2020-09-09 16:29:11.904682 | 007
 ui000004   | 2020-02-11 19:41:31.904682 | james bond
 ui000005   | 2020-01-02 15:29:41.904682 | harrison ford
 ui000005   | 2020-07-06 16:42:41.904682 | indiana jones
 ui000006   | 2020-10-23 12:29:21.904682 | the blacklist
 ui000006   | 2020-09-02 11:44:51.904682 | the simpsons
(17 rows)

SELECT * FROM string_search('Remake', 'ui000001');
   tconst   |                          primarytitle                           
------------+-----------------------------------------------------------------
 tt0734731  | Shadow Play/Grace Note
 tt12266294 | Remakes, Remasters and Rereleases
 tt8874852  | Most Wanted HD Remakes
 tt3907180  | Remake, Remix, Rip-Off: About Copy Culture & Turkish Pop Cinema
 tt0245844  | The Count of Monte Cristo
 tt2028462  | 30 Anos de Chaves
 tt3716398  | Pokémon Alpha Sapphire
 tt5034320  | Kingdom Hearts HD 2.8 Final Chapter Prologue
 tt9839526  | The Legend of Zelda: Link's Awakening
 tt6027478  | Dhruva
 tt9844256  | Code Geass: Lelouch of the Rebellion III - Glorification
 tt0488478  | 12
 tt6057416  | Final Fantasy VII Remake
 tt7826034  | Resident Evil 2
 tt0334226  | Remake
 tt3520344  | Mysterious Disc
 tt5161760  | The Clown
 tt3716344  | Pokémon Omega Ruby
 tt7927838  | Shadow of the Colossus
 tt0734662  | The Mind and the Matter
 tt4997858  | Risen: The Story of Chron 'Hell Razah' Smith
 tt2431488  | Explode for Me
 tt2095753  | Rock Hunter in 3D
 tt7293238  | Remake
 tt10981530 | Peaky Blinders - Remake
 tt8598482  | Luigi's Mansion
(26 rows)

SELECT * FROM search_history;
   uconst   |           tstamp           |    search     
------------+----------------------------+---------------
 ui000001   | 2020-10-08 14:23:51.904682 | harry potter
 ui000001   | 2020-09-09 16:29:11.904682 | Dicaprio
 ui000002   | 2020-02-11 19:41:31.904682 | apples
 ui000002   | 2020-01-02 15:19:41.904682 | 2008
 ui000002   | 2020-07-06 16:42:41.904682 | rupert gint
 ui000003   | 2020-10-23 12:29:21.904682 | good place
 ui000003   | 2020-09-09 16:29:11.904682 | teeth
 ui000003   | 2020-02-11 19:41:31.904682 | limitless
 ui000003   | 2020-01-02 15:19:41.904682 | 2008
 ui000004   | 2020-07-06 16:42:41.904682 | skjdsdf
 ui000004   | 2020-10-23 12:29:21.904682 | agent 47
 ui000004   | 2020-09-09 16:29:11.904682 | 007
 ui000004   | 2020-02-11 19:41:31.904682 | james bond
 ui000005   | 2020-01-02 15:29:41.904682 | harrison ford
 ui000005   | 2020-07-06 16:42:41.904682 | indiana jones
 ui000006   | 2020-10-23 12:29:21.904682 | the blacklist
 ui000006   | 2020-09-02 11:44:51.904682 | the simpsons
 ui000001   | 2020-10-11 10:51:27.582051 | Remake
(18 rows)

-- D.3
-- D.4 Structured String Search
-- Test case: find all movies with structured search with 4 parameters,
-- 	      title name, plot, characters and name,
-- 	      lower and upper case characters added including empty parameters
SELECT * FROM structured_string_search('', 'see', '', 'Mads miKKelsen', 'ui000001');
   tconst   | primarytitle  
------------+---------------
 tt0418455  | Adam's Apples
(1 row)

-- D.5 Actor Search
-- Test case: find all actor names with actor search with 1 parameter on actor name or character
SELECT * FROM actor_search('Mads Mikkelsen', 'ui000001');
   nconst   |  primaryname   
------------+----------------
 nm0586568  | Mads Mikkelsen
 nm0586568  | Mads Mikkelsen
 nm0586568  | Mads Mikkelsen
 nm0586568  | Mads Mikkelsen
(4 rows)

-- D.6
-- D.7
-- D.8
-- D.9
-- D.10
-- D.11 Exact-match Querying
-- Test case D11a: find titles by searching on 3 intersecting keywords in inverted index wi
SELECT * FROM exact_match_search('apple', 'mads', 'mikkelsen', 'ui000001');
   tconst   | primarytitle  
------------+---------------
 tt0418455  | Adam's Apples
(1 row)

-- D.12 Best-match Querying
-- Test case D.12a: find ranked titles with multiple paramters by using VARIADIC array
SELECT * FROM dynamic_bestmatch('apple', 'mads', 'mikkelsen');
   tconst   | rank |                             title                             
------------+------+---------------------------------------------------------------
 tt0418455  |    3 | Adam's Apples
 tt0457655  |    2 | After the Wedding
 tt2106476  |    2 | The Hunt
 tt5807606  |    2 | Death Stranding
 tt0428441  |    1 | The Cutting Edge: The Magic of Movie Editing
 tt0439704  |    1 | Milk Can
 tt0449056  |    1 | Lick an Apple Like a Pussy: The Movie Stanislawski Never Made
 tt0495865  |    1 | Nandini
 tt0697753  |    1 | The Pie
 tt0758433  |    1 | The Person de Leo N.
 tt0765125  |    1 | Noget om Halfdan
 tt10055344 |    1 | NXT TakeOver: New York
 tt10131114 |    1 | Apple at Work - The Underdogs
 tt10283234 |    1 | Ratrir Jatri
 tt1040004  |    1 | Seducer's Fall
 tt1090643  |    1 | Att: Kasimir
 tt11213810 |    1 | Aurora: Apple Tree
 tt12066446 |    1 | Alan Walker & Ruben: Heading Home
 tt1217553  |    1 | ...Og det var Danmark
 tt12351942 |    1 | The Most Dangerous Concert Ever: The Morricone Duel
 tt1326214  |    1 | Downtown Calling
 tt1340454  |    1 | Our Neck of the Woods
 tt1385513  |    1 | The Distance Between the Apple and the Tree
 tt1568292  |    1 | The Buffalo Son
 tt1572002  |    1 | En stemme for livet
 tt1586732  |    1 | Death, Taxes and Apple Juice
 tt1735910  |    1 | The Capsule
 tt1784493  |    1 | King for Two Days
 tt1853535  |    1 | De genfødte
 tt1854312  |    1 | Music
 tt1928116  |    1 | Assassin's Creed: Revelations
 tt2036416  |    1 | You Are the Apple of My Eye
 tt2056563  |    1 | Easy Under the Apple Bough
 tt2104994  |    1 | Steve Jobs: The Lost Interview
 tt2132321  |    1 | Eden
 tt2342437  |    1 | Words of Captain Scott
 tt2435152  |    1 | The Loving Dead
 tt2560114  |    1 | Passio
 tt2836568  |    1 | Det røde eplet
 tt2995858  |    1 | Hitman
 tt3177386  |    1 | A Day in the Country
 tt3542412  |    1 | Erik & Else
 tt3615116  |    1 | Paradise Hotel
 tt3711064  |    1 | Deliver Us
 tt3980364  |    1 | Inside
 tt4011396  |    1 | Greed Eats the Soul
 tt4046102  |    1 | The Permaculture Orchard: Beyond Organic
 tt4130308  |    1 | An Island
 tt4321796  |    1 | Blue
 tt4499186  |    1 | Portrait of a Garden
 tt4643086  |    1 | Ávaxtakarfan
 tt4659056  |    1 | The Day Will Come
 tt4771548  |    1 | Apple: Backstage
 tt4997858  |    1 | Risen: The Story of Chron 'Hell Razah' Smith
 tt5316590  |    1 | For min datter
 tt5612428  |    1 | Sunless
 tt5709838  |    1 | Avatar: The Eagle Has Landed
 tt5801184  |    1 | Blindsided
 tt5816540  |    1 | Susanne Sundfør: Accelerate
 tt5890754  |    1 | The Taste of Apple
 tt6190908  |    1 | Hugo På Bas
 tt6202076  |    1 | Leaked
 tt6326340  |    1 | O' Bloody Night
 tt6441102  |    1 | Complicit
 tt6603666  |    1 | Maximillian
 tt6668018  |    1 | Påfugl Blant duer
 tt6746062  |    1 | Paradigm
 tt7010412  |    1 | The Great Buddha +
 tt7144150  |    1 | Det Glade Postbud
 tt7305820  |    1 | Past and Present
 tt7310086  |    1 | Deadline
 tt7313322  |    1 | Alpha and Omega
 tt8015190  |    1 | Apple iPhone 8 & iPhone X: Official Trailer - Parody
 tt8106994  |    1 | Welcome Home
 tt8346546  |    1 | Love Notes to Newton
 tt8525684  |    1 | Hitman 2
 tt8835200  |    1 | The In-Between
 tt8998634  |    1 | Maid in Hell
 tt9004986  |    1 | Syndebukken: Prosessen mot Harry Lindstrøm
 tt9150630  |    1 | Markets
 tt9460980  |    1 | Sunday
 tt9643290  |    1 | The Story of an Apple
 tt9665540  |    1 | De Hvi'
 tt9720546  |    1 | Løvernes Konge
 tt9720550  |    1 | The Goatkeeper
 tt9720554  |    1 | Run Sunday, Run
 tt9720558  |    1 | Mushi Mushi
 tt9720560  |    1 | The Lion King
 tt9720564  |    1 | Big Bowl
 tt0339723  |    1 | The Star Dreamer
 tt9720566  |    1 | Forhandleren
 tt0392787  |    1 | Nimbus '47
 tt0406282  |    1 | Bubbles
 tt0417459  |    1 | Back to Manhattan
(94 rows)

-- Test case D.12b: find ranked titles with single paramter by using VARIADIC array
SELECT * FROM dynamic_bestmatch('apple');
   tconst   | rank |                             title                             
------------+------+---------------------------------------------------------------
 tt0417459  |    1 | Back to Manhattan
 tt0418455  |    1 | Adam's Apples
 tt0428441  |    1 | The Cutting Edge: The Magic of Movie Editing
 tt0449056  |    1 | Lick an Apple Like a Pussy: The Movie Stanislawski Never Made
 tt0697753  |    1 | The Pie
 tt0758433  |    1 | The Person de Leo N.
 tt10055344 |    1 | NXT TakeOver: New York
 tt10131114 |    1 | Apple at Work - The Underdogs
 tt10283234 |    1 | Ratrir Jatri
 tt11213810 |    1 | Aurora: Apple Tree
 tt1326214  |    1 | Downtown Calling
 tt1385513  |    1 | The Distance Between the Apple and the Tree
 tt1568292  |    1 | The Buffalo Son
 tt1586732  |    1 | Death, Taxes and Apple Juice
 tt1735910  |    1 | The Capsule
 tt1784493  |    1 | King for Two Days
 tt1854312  |    1 | Music
 tt1928116  |    1 | Assassin's Creed: Revelations
 tt2036416  |    1 | You Are the Apple of My Eye
 tt2056563  |    1 | Easy Under the Apple Bough
 tt2104994  |    1 | Steve Jobs: The Lost Interview
 tt2132321  |    1 | Eden
 tt2435152  |    1 | The Loving Dead
 tt2836568  |    1 | Det røde eplet
 tt3177386  |    1 | A Day in the Country
 tt3615116  |    1 | Paradise Hotel
 tt3711064  |    1 | Deliver Us
 tt4011396  |    1 | Greed Eats the Soul
 tt4046102  |    1 | The Permaculture Orchard: Beyond Organic
 tt4499186  |    1 | Portrait of a Garden
 tt4643086  |    1 | Ávaxtakarfan
 tt4771548  |    1 | Apple: Backstage
 tt4997858  |    1 | Risen: The Story of Chron 'Hell Razah' Smith
 tt5612428  |    1 | Sunless
 tt5709838  |    1 | Avatar: The Eagle Has Landed
 tt5801184  |    1 | Blindsided
 tt5890754  |    1 | The Taste of Apple
 tt6441102  |    1 | Complicit
 tt6746062  |    1 | Paradigm
 tt7010412  |    1 | The Great Buddha +
 tt8015190  |    1 | Apple iPhone 8 & iPhone X: Official Trailer - Parody
 tt8106994  |    1 | Welcome Home
 tt8346546  |    1 | Love Notes to Newton
 tt9150630  |    1 | Markets
 tt9643290  |    1 | The Story of an Apple
(45 rows)

-- D.13
-- no solution
-- D.14
-- no solution
-- D.15
-- no solution
